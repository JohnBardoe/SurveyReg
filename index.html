<html>
<head>
    <!--bootstrap-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!--<script src="https://code.jquery.com/jquery-3.4.1.js" integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>-->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>

    <title>Fire safety</title>
    <link rel="stylesheet" href="styles.css">


    <script>
const maxTeam = 15;

function addFields($grade, $team){
        $('<input />').attr('type', 'hidden')
            .attr('name', 'grade')
            .attr('value', $grade)
            .appendTo('#regForm');
        $('<input />').attr('type', 'hidden')
            .attr('name', 'team')
            .attr('value', $team)
            .appendTo('#regForm');
    $('form#regForm').submit();
}

function makeNameBox() {
    $('.name-text').append("<label for=\"name\">Name</label>\n" +
        "    <input type=\"text\" class=\"form-control spacing_main\" name='name' id=\"name\" placeholder=\"Beep boop\" required=\"true\">");
    $('.name-text').append("<label for=\"name\">Surname</label>\n" +
        "    <input type=\"text\" class=\"form-control spacing_main\" name='surname' id=\"surname\" placeholder=\"(i'm a robot, sry)\" required=\"true\">");
}
function outputColoumn($grade){
    $('.team-list').empty();
    $('.name-text').empty();
    $('.selector-submitter').empty();

    $('.name-text').append(" <div class='d-flex'> <hr class='my-auto flex-grow-1'> <div class='px-4'> Fill in your name </div> <hr class='my-auto flex-grow-1'> </div> ");
    makeNameBox()
    $('.name-text').append(" <div class='d-flex'> <hr class='my-auto flex-grow-1'> <div class='px-4'> Team observer </div> <hr class='my-auto flex-grow-1'> </div> ");

    let data = [[[],[],[],[],[]],
        [[],[],[],[],[]],
        [[],[],[],[],[],[]]];

    $.ajax({
        type:'POST',
        url:'fetchTeams.php',
        dataType: 'json',
        data: data,
        success:function(data){
            for(let i = 0; i < data[$grade].length; i++) {
                $('.team-list').append("<div class=\"card\" style=\"width: 18rem;\">\n" +
                    "  <div class=\"card-header container-fluid\">\n" +
                    "Team " + (i+1) +
                    "      <button class=\"col-md-3 float-right btn btn-primary\" id='tmb-" + (i+1)+ "'>Join</button> "+
                    "  </div>\n" +
                    "  <ul class=\"list-group list-group-flush\">");
                for(let j = 0; j < data[$grade][i].length; j++)
                    $('.team-list').append("<li class=\"list-group-item\" style=\"width: 18rem;\">"+ data[$grade][i][j] +"</li>");
                $('.team-list').append("</ul></div>");
            }
        }});

    $(document).on("click", "#tmb-1" , function() {
        addFields($grade, 1);
    });

    $(document).on("click", "#tmb-2" , function(){
        addFields($grade, 2);
    });

    $(document).on("click", "#tmb-3" , function(){
        addFields($grade, 3);
    });

    $(document).on("click", "#tmb-4" , function(){
        addFields($grade, 4);
    });

    $(document).on("click", "#tmb-5" , function(){
        addFields($grade, 5);
    });
    if($grade === 2){
        $(document).on("click", "#tmb-6" , function(){
            addFields($grade, 6);
        });

    }


}
$(document).ready(function(){
    let grade;
    let team;
    $('#grade_s').on('click',function(){
        outputColoumn(0);
        grade = 0;
    });
    $('#grade_e').on('click',function(){
        outputColoumn(1);
        grade = 1;
    });
    $('#grade_n').on('click',function(){
        outputColoumn(2);
        grade = 2;
    });

});
</script>
</head>

<body>
<div class="jumbotron text-center">
    <h1>Fire safety</h1>
    <p>This is where the text is supposed to be...</p>
</div>

<div class="d-flex">
  <hr class="my-auto flex-grow-1">
  <div class="px-4">
      Select your grade
  </div>
    <hr class="my-auto flex-grow-1">
</div>

<div class='container'>
    <div class='row'>
        <div class='col-sm'>
            <button type="button" class="btn btn-outline-success" id='grade_s'>7 grade</button>
        </div>
        <div class='col-sm'>
            <button type="button" class="btn btn-outline-success" id='grade_e'>8 grade</button>
        </div>
        <div class='col-sm'>
            <button type="button" class="btn btn-outline-success" id='grade_n'>9 grade</button>
        </div>
    </div>
</div>
<form id="regForm" action="/newMember.php" method="post">
    <div class="name-text form-group"></div>
</form>

<div class='team-list'></div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
</body>
</html>